---
title: コンシステントハッシュ
createdDate: 2025-01-21T11:26:55.634Z
description: コンシステントハッシュの仕組みについて解説いたします。
tags:
  - 設計
iconUrl: https://raw.githubusercontent.com/microsoft/fluentui-emoji/main/assets/Hear-no-evil%20monkey/Flat/hear-no-evil_monkey_flat.svg
---

## コンシステントハッシュとは

ハッシュテーブルのサイズが変更されてコンシステントハッシュが使用されてとき、平均してk/n個のキーしか再マッピングする必要がない特殊なハッシュのこと。
従来のほとんどのハッシュテーブルは、配列のスロット数が変わると、ほぼ全てのキーが再マッピングされることになる。

## 再ハッシュ問題

キャッシュサーバがn台あるとき、負荷分散させる一般的な方法として、以下のようなハッシュ方式がある。

$$
serverIndex = hash(key) % N (n = サーバプールの大きさ)
$$

## ハッシュ空間とハッシュリング

ハッシュ関数fとして、SHA-1を使い、ハッシュ関数の出力範囲を $x0, x1, x2, x3,・・・・,xn$ とする。

## ハッシュサーバ

## ハッシュキー

## サーバの探索

## サーバの追加

## サーバの削除

## コンシステントハッシュアルゴリズムの問題点

## 仮想ノード
